# nginx

nginx หรือ Engine-X เป็นเว็บเซอร์เวอร์ที่นิยมใช้ในปัจจุบัน เพราะรองรับการใช้งานที่หลากหลายกว่าเว็บเซอร์เวอร์อย่าง apache และยังมีประสิทธิภาพในการทำงานที่สูง 

nginx ถูกพัฒนาเมื่อปี 2547 โดยอิกอร์ซิสโซอีฟ ลักษณะการใช้งานจะใช้ควบคู่กับ Apache Web Server โดยใช้ nginx รับ request ส่งไปยัง Apache เพื่อส่งให้ PHP แสดงผล [1]

## วิธีการลงและใช้งาน nginx ในระบบปฏิบัติการ Linux (Ubuntu) [2]

1. ก่อนการติดตั้ง nginx ให้อัปเดทแพ็กเกจก่อน

        sudo apt update

2. จากนั้นทำการติดตั้ง nginx โดยใช้คำสั่ง

        sudo apt install nginx

    เมื่อรับแจ้งให้ดำเนินการต่อให้กด Y บนแป้นพิมพ์แล้ว Enter

3. เมื่อติดตั้งสำเร็จ ให้เริ่มต้นการทำงานและตรวจสอบโดยเรียกใช้

        sudo systemctl start nginx
        sudo systemctl status nginx

4. หากต้องการตรวจสอบเวอร์ชั่นของ nginx ให้เรียกใช้

        sudo dpkg -l nginx

### เปิดพอร์ต nginx บนไฟร์วอลล์ UFW

เมื่อคุณได้ติดตั้ง nginx เสร็จเรียบร้อยแล้ว หากคุณใช้ไฟร์วอลล์ UFW คุณจำเป็นจะต้องอนุญาตโปรไฟล์ nginx 

โดยทั่วไปแล้วจะมี nginx อยู่ 3 โปรไฟล์ที่เกี่ยวกับไฟร์วอลล์ UFW

1. nginx เต็ม ซึ่งเปิดทั้งพอร์ต 80 และ 443 (สำหรับการเข้ารหัสแบบ SSL/TLS)
2. nginx แบบ HTTP จะเปิดเฉพาะพอร์ต 80 (สำหรับเว็บที่ไม่มีการเข้ารหัส)
3. nginx แบบ HTTPS จะเปิดเฉพาะพอร์ต 443 (สำหรับการเข้ารหัสแบบ SSL/TLS)


1. เริ่มต้นเปิดใช้งานไฟร์วอลล์ใน Ubuntu โดยให้เรียกใช้
        
        sudo ufw enable

2. ในตอนนี้เราไม่ได้อยู่บนเซิร์ฟเวอร์ที่เข้ารหัส เพราะฉะนั้นเราจะอนุญาตเฉพาะโปรไฟล์ nginx แบบ HTTP ที่เปิดเฉพาะพอร์ต 80 โดยใช้คำสั่ง

        sudo ufw allow 'Nginx HTTP'

3. จากนั้นให้ทำการโหลดไฟร์วอลล์ใหม่ เพื่อให้การเปลี่ยนแปลงคงอยู่

        sudo ufw reload

4. จากนั้นให้ตรวจสอบไฟร์วอลล์เพื่อตรวจสอบโปรไฟล์ที่ได้รับอนุญาต โดยใช้คำสั่ง

        sudo ufw status

### ทำการทดสอบ nginx 

Nginx ทำงานบนเบราว์เซอร์ ดังนั้นวิธีในการทดสอบว่า nginx ทำงานที่ดีที่สุดคือการส่งคำขอผ่านเบราว์เซอร์

1. ไปทื่เว็บเบราว์เซอร์และดูที่อยู่ IP หรือโดเมนของเซอร์เวอร์ หากต้องการตรวจสอบ IP ของเซอร์เวอร์ของคุณให้รันคำสั่ง

        ifconfig

2. หากคุณอยู่บนเซอร์เวอร์ cloud ให้รันคำสั่ง 

        curl ifconfig.me

3. ในช่อง url ของเบราว์เซอร์ให้คุณป้อนที่อยู่ไอพีของคุณ และกด ENTER เช่น

    http://server-IP or domain-name 

    คุณจะได้รับหน้าต่างต้อนรับเริ่มต้นของ nginx 

### คำสั่งต่างๆ ที่ใช้จัดการ nginx

| คำสั่ง | ความหมาย |
| ---- | -------- |
| sudo systemctl stop nginx | หยุดเว็บเซอร์เวอร์ของ nginx |
| sudo systemctl start nginx | สั่งให้เว็บเซอร์เวอร์เริ่มทำงาน |
| sudo systemctl enable nginx | หากต้องการเริ่ม nginx โดยอัตโนมัติขณะบู๊ดหรือรีบู๊ต |
| sudo systemctl restart nginx | หากต้องการรีสตาร์ทเว็บเซอร์เวอร์ |
| sudo systemctl reload nginx | ทำการโหลดซ้ำ เพื่อหลีกเลี่ยงการเชื่อมต่อหลุด

## Reference

https://blog.metrabyte.cloud/nginx-%E0%B8%84%E0%B8%B7%E0%B8%AD%E0%B8%AD%E0%B8%B0%E0%B9%84%E0%B8%A3-nginx-web-server/ [1]

https://th.linux-console.net/?p=1815 [2]

